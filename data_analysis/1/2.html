<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>数值分析</title>
</head>
<style type="text/css">
canvas
{
	border: 1px solid #9C9898;
} 
</style>
</head>
<body>
<canvas id="myCanvas" width="600" height="800"></canvas>
<canvas id="myCanvas1" width="600" height="800"></canvas>
<span id = "s1"></span><br>
<span id = "s2"></span><br>
<span id = "s3"></span><br>
<span id = "s4"></span><br><br><br>d
<span id = "x1"></span><br>
<span id = "x2"></span><br>
<span id = "x3"></span><br>
<span id = "x4"></span><br>
 <script src="jquery-1.11.3.min.js"></script>
<script>
/*var canvas = document.getElementById('myCanvas');
var cxt=canvas.getContext("2d");
cxt.moveTo(10,10);
cxt.lineTo(150,50);
cxt.lineTo(10,50);
cxt.stroke();*/
var x = new Array(0.25,0.30,0.39,0.45,0.53);
var y = new Array(0.5000,0.5477,0.6245,0.6708,0.7280);
var h = new Array();
var u = new Array();
var r = new Array();
var d = new Array();
var w = new Array();
var z = new Array();
var m = new Array();
var l = new Array();
var p1 = new Array();
var p2 = new Array();
var p3 = new Array();
var p4 = new Array();

function main() {
	var s0 = 1.0000,sn = 0.6868;
	calculate1(s0,sn);
	var y1 = p1[0]+'x^3  + ' + p2[0] + 'x^2 +  ' + p3[0] + 'x  + ' + p4[0]; 
	var y2 = p1[1]+'x^3  + ' + p2[1] + 'x^2   + ' + p3[1] + 'x  + ' + p4[1]; 
	var y3 = p1[2]+'x^3  + ' + p2[2] + 'x^2   + ' + p3[2] + 'x +  ' + p4[2]; 
	var y4 = p1[3]+'x^3  + ' + p2[3] + 'x^2  + ' + p3[3] + 'x +  ' + p4[3]; 
	$("#s1").text(y1);
	$("#s2").text(y2);
	$("#s3").text(y3);
	$("#s4").text(y4);
	var canvas = document.getElementById('myCanvas');
	var cxt=canvas.getContext("2d");
	var yyy1 = p1[0] * x[0] * x[0] * x[0] + p2[0] * x[0] * x[0] + p3[0] * x[0] + p4[0];
	//cxt.moveTo(100,100);
	//cxt.lineTo(150,50);
	//cxt.lineTo(10,50);
	//cxt.moveTo(10,10);
	cxt.moveTo(x[0]*1000,800-yyy1*1000);
	//cxt.lineTo(150,50);
	//cxt.lineTo(10,50);
	//cxt.stroke();
	for(var i = x[0]; i < x[1];) {
		var yyy = p1[0] * i * i * i + p2[0] * i * i + p3[0] * i + p4[0];
		cxt.lineTo(i*1000,800-yyy*1000);
		i = i + 0.01;
	}
	for(var i = x[1]; i < x[2];) {
		var yyy = p1[1] * i * i * i + p2[1] * i * i + p3[1] * i + p4[1];
		cxt.lineTo(i*1000,800-yyy*1000);
		i = i + 0.01;
	}
	for(var i = x[2]; i < x[3];) {
		var yyy = p1[2] * i * i * i + p2[2] * i * i + p3[2] * i + p4[2];
		cxt.lineTo(i*1000,800-yyy*1000);
		i = i + 0.01;
	}
	for(var i = x[3]; i < x[4];) {
		var yyy = p1[3] * i * i * i + p2[3] * i * i + p3[3] * i + p4[3];
		cxt.lineTo(i*1000,800-yyy*1000);
		i = i + 0.01;
	}
	cxt.stroke();
	calculate2();
	//$("#s1").text(p2[0]);
	var yy1 = p1[0]+'x^3  + ' + p2[0] + 'x^2  + ' + p3[0] + 'x  + ' + p4[0]; 
	var yy2 = p1[1]+'x^3  + ' + p2[1] + 'x^2 +  ' + p3[1] + 'x  + ' + p4[1]; 
	var yy3 = p1[2]+'x^3  + ' + p2[2] + 'x^2 +  ' + p3[2] + 'x +  ' + p4[2]; 
	var yy4 = p1[3]+'x^3  + ' + p2[3] + 'x^2  + ' + p3[3] + 'x  + ' + p4[3]; 
	$("#x1").text(yy1);
	$("#x2").text(yy2);
	$("#x3").text(yy3);
	$("#x4").text(yy4);
	var canvas1 = document.getElementById('myCanvas1');
	var cxt1=canvas1.getContext("2d");
	var yyy1 = p1[0] * x[0] * x[0] * x[0] + p2[0] * x[0] * x[0] + p3[0] * x[0] + p4[0]; 
	cxt1.moveTo(x[0]*1000,800-yyy1*1000);
	//cxt.lineTo(150,50);
	//cxt.lineTo(10,50);
	//cxt.stroke();
	for(var i = x[0]; i < x[1];) {
		var yyy = p1[0] * i * i * i + p2[0] * i * i + p3[0] * i + p4[0];
		cxt1.lineTo(i*1000,800-yyy*1000);
		i += 0.01;
	}
	for(var i = x[1]; i < x[2];) {
		var yyy = p1[1] * i * i * i + p2[1] * i * i + p3[1] * i + p4[1];
		cxt1.lineTo(i*1000,800-yyy*1000);
		i += 0.01;
	}
	for(var i = x[2]; i < x[3];) {
		var yyy = p1[2] * i * i * i + p2[2] * i * i + p3[2] * i + p4[2];
		cxt1.lineTo(i*1000,800-yyy*1000);
		i += 0.01;
	}
	for(var i = x[3]; i < x[4];) {
		var yyy = p1[3] * i * i * i + p2[3] * i * i + p3[3] * i + p4[3];
		cxt1.lineTo(i*1000,800-yyy*1000);
		i += 0.01;
	}
	cxt1.stroke();

}

function calculate1(s0,sn) {
	
	var len = x.length;
	for(var i = 0; i < len - 1; i++) 
		h[i] = x[i+1] - x[i];//h
	for(var i = 1; i < len - 1; i++) 
		u[i] = h[i-1] / (h[i-1] + h[i]);//miu
	u[len - 1] = 1;
	for(var i = 1; i < len - 1; i++) 
		r[i] = h[i] / (h[i-1]+h[i]);//lan
	r[0] = 1;
	d[0]=(6*((y[0]-y[1])/(x[0]-x[1])-s0))/h[0];//d0,dn单独考虑
	d[len-1]=(6*(sn-(y[len-2]-y[len-1])/(x[len-2]-x[len-1])))/h[len-2];
	for(var i=1;i<len-1;i++) 
		d[i]=(6*((y[i]-y[i+1])/(x[i]-x[i+1])-(y[i-1]-y[i])/(x[i-1]-x[i])))/(h[i-1]+h[i]);
	w[0]=2;
	z[0]=d[0];
	//追赶法
	for(var i=1;i<len;i++) {
		l[i]=u[i]/w[i-1];
		w[i]=2-l[i]*r[i-1];
		z[i]=d[i]-l[i]*z[i-1];
	}
	m[len-1]=z[len-1]/w[len-1];
	for(var i=len-2;i>=0;i--) {
		m[i]=(z[i]-r[i]*m[i+1])/w[i];
	}
	for(var i = 0; i < len - 1; i++) {
		p1[i]=m[i+1]/(6*h[i])-m[i]/(6*h[i]);
		p2[i]=m[i]*x[i+1]*3/(6*h[i])-m[i+1]*3*x[i]/(6*h[i]);
		p3[i]=m[i+1]*3*x[i]*x[i]/(6*h[i])-m[i]*(3*x[i+1]*x[i+1])/(6*h[i])-(y[i]-m[i]*h[i]*h[i]/6)/h[i]+(y[i+1]-m[i+1]*h[i]*h[i]/6)/h[i];
		p4[i]=m[i]*x[i+1]*x[i+1]*x[i+1]/(6*h[i])-m[i+1]*x[i]*x[i]*x[i]/(6*h[i])+(y[i]-m[i]*h[i]*h[i]/6)*x[i+1]/h[i]-(y[i+1]-m[i+1]*h[i]*h[i]/6)*x[i]/h[i];
	}
}
function calculate2() {
	var len = x.length;
	for(var i = 0; i < len -1;i++) 
		h[i]=x[i+1]-x[i];
	for(var i=1;i<len-1;i++)//求μ
		u[i]=h[i-1]/(h[i-1]+h[i]);
	u[len-1]=0;
	for(var i=1;i<len-1;i++)//求
		r[i]=h[i]/(h[i-1]+h[i]);
	r[0]=0;
	d[0]=0;
	d[len-1]=0;
	for(var i=1;i<len-1;i++) {
		d[i]=(6*((y[i]-y[i+1])/(x[i]-x[i+1])-(y[i-1]-y[i])/(x[i-1]-x[i])))/(h[i-1]+h[i]);
	}
	
	w[0]=2;//U
	z[0]=d[0];//Y
	//追赶法
	for(var i=1;i<len;i++){
		l[i]=u[i]/w[i-1];//L
		w[i]=2-l[i]*r[i-1];
		z[i]=d[i]-l[i]*z[i-1];
	}
	m[len-1]=0;
	m[0]=0;
	for(var i=len-2;i>0;i--){
		m[i]=(z[i]-r[i]*m[i+1])/w[i];
	}
	for(var i = 0; i < len; i++ ) {
		p1[i]=m[i+1]/(6*h[i])-m[i]/(6*h[i]);
		p2[i]=m[i]*x[i+1]*3/(6*h[i])-m[i+1]*3*x[i]/(6*h[i]);
		p3[i]=m[i+1]*3*x[i]*x[i]/(6*h[i])-m[i]*(3*x[i+1]*x[i+1])/(6*h[i])-(y[i]-m[i]*h[i]*h[i]/6)/h[i]+(y[i+1]-m[i+1]*h[i]*h[i]/6)/h[i];
		p4[i]=m[i]*x[i+1]*x[i+1]*x[i+1]/(6*h[i])-m[i+1]*x[i]*x[i]*x[i]/(6*h[i])+(y[i]-m[i]*h[i]*h[i]/6)*x[i+1]/h[i]-(y[i+1]-m[i+1]*h[i]*h[i]/6)*x[i]/h[i];
	}
}
main();
</script>
</body>
</html>